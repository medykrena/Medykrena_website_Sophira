<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sophira – Verein für berufliche Neuorientierung</title>

  <link rel="alternate" hreflang="fr" href="https://sophira.ch/jobs/index.html" />
  <link rel="alternate" hreflang="de" href="https://sophira.ch/jobs/index-de.html" />
  <link rel="alternate" hreflang="x-default" href="https://sophira.ch/jobs/index.html" />

  <!-- GA4 + Consent Mode v2 (Standard: abgelehnt) -->
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('consent','default',{
      ad_storage:'denied',
      analytics_storage:'denied',
      functionality_storage:'granted',
      security_storage:'granted',
      ad_user_data:'denied',
      ad_personalization:'denied',
      wait_for_update:500
    });
  </script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FL1S0MJWB1"></script>
  <script>
    gtag('js', new Date());
    gtag('config', 'G-FL1S0MJWB1');
  </script>

  <!-- SEO Basis -->
  <link rel="canonical" href="https://sophira.ch/index-de.html" />
  <meta name="robots" content="index,follow" />
  <meta name="description" content="Sophira unterstützt Erwachsene in finanziellen Schwierigkeiten bei ihrer beruflichen Neuorientierung in Zukunftsberufe (Daten, grüne Technologien, digitale Gesundheit, KI) in der Schweiz." />

  <!-- Hreflang -->
  <link rel="alternate" hreflang="fr" href="https://sophira.ch/index.html" />
  <link rel="alternate" hreflang="de" href="https://sophira.ch/index-de.html" />
  <link rel="alternate" hreflang="x-default" href="https://sophira.ch/index.html" />

  <!-- Open Graph / Social -->
  <meta property="og:title" content="Sophira – Verein für berufliche Neuorientierung" />
  <meta property="og:description" content="Arbeitslosigkeit durch Automatisierung bekämpfen und Chancen in Zukunftsberufen eröffnen." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://sophira.ch/index-de.html" />
  <meta property="og:image" content="https://sophira.ch/Logo_sophira.png" />
  <meta property="og:site_name" content="Sophira" />
  <meta property="og:locale" content="de_CH" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Sophira – Verein für berufliche Neuorientierung" />
  <meta name="twitter:description" content="Sophira hilft Erwachsenen, sich in der Schweiz in Zukunftsberufe neu zu orientieren." />
  <meta name="twitter:image" content="https://sophira.ch/Logo_sophira.png" />

  <!-- Browser-Farbe & Icons -->
  <meta name="theme-color" content="#1a73e8" />
  <link rel="icon" href="/favicon.ico" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

  <!-- Schrift -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <!-- Strukturierte Daten (Organisation) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "NonprofitOrganization",
    "name": "Sophira",
    "url": "https://sophira.ch/",
    "logo": "https://sophira.ch/Logo_sophira.png",
    "foundingLocation": "Basel, Schweiz",
    "areaServed": "CH",
    "sameAs": [],
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Basel",
      "addressCountry": "CH"
    }
  }
  </script>

  <style>
    :root{
      --text:#2c3e50;
      --muted:#4a5568;
      --brand:#1a73e8;
      --brand-hover:#155ab6;
      --whiteglass:#ffffffdd;
      --panel:#edf2f7cc;
      --radius:12px;
      --shadow-sm:0 2px 8px rgba(0,0,0,.05);
      --shadow-md:0 4px 12px rgba(0,0,0,.08);
      --container:980px;
      --focus:#0d6efd;
      --focus-bg:#e8f0fe;
      --z-header:20;
      --z-lang:60;
      --z-cookie:70;
    }
    *{box-sizing:border-box}
    html:focus-within{ scroll-behavior:smooth; }
    body{
      margin:0; font-family:'Inter',sans-serif;
      background:url('mathew-schwartz-91ryOVMlBJc-unsplash.jpg') no-repeat center center fixed;
      background-size:cover; color:var(--text);
    }
    body.no-scroll{ overflow:hidden; }

    .skip-link{
      position:absolute; left:1rem; top:.5rem;
      transform:translateY(-200%);
      background:#000; color:#fff; padding:.6rem .9rem; border-radius:8px;
      text-decoration:none; z-index:1000; box-shadow:var(--shadow-sm);
    }
    .skip-link:focus, .skip-link:focus-visible{ transform:translateY(0); outline:2px solid #fff; }

    .overlay{ min-height:100vh; background:rgba(255,255,255,.9); display:flex; flex-direction:column; }

    header.navbar{
      position:sticky; top:0; z-index:var(--z-header);
      display:flex; align-items:center; justify-content:space-between; gap:.75rem;
      padding:.8rem 1rem; background:var(--whiteglass); box-shadow:var(--shadow-sm); backdrop-filter: blur(6px);
    }
    .brand{ display:flex; align-items:center; gap:.6rem; min-width:0; text-decoration:none; }
    .brand img{ height:48px; width:auto; }
    .brand h1{
      margin:0; font-size:1.55rem; font-weight:600; color:#1a202c; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    @media (max-width:480px){
      .brand img{ height:44px; }
      .brand h1{ font-size:1.35rem; }
    }

    nav.primary{ display:flex; gap:1.1rem; align-items:center; }
    nav.primary a{ text-decoration:none; color:var(--text); font-weight:500; }
    nav.primary a:hover, nav.primary a:focus{ color:#1e88e5; }

    a:focus-visible, button:focus-visible{
      outline:3px solid var(--focus);
      outline-offset:2px;
      background:linear-gradient(0deg, var(--focus-bg), var(--focus-bg)) no-repeat;
    }

    .controls{ display:flex; align-items:center; gap:.5rem; position:relative; }

    .burger{ display:none; background:none; border:none; padding:.4rem .6rem; border-radius:8px; }
    .burger svg{ width:28px; height:28px; }

    .lang-btn{
      display:inline-flex; align-items:center; gap:.35rem;
      background:#fff; border:1px solid #e5e7eb; border-radius:999px; padding:.35rem .6rem;
      font-weight:600; color:#1f2937; cursor:pointer; box-shadow:var(--shadow-sm);
    }
    .lang-btn svg{ width:18px; height:18px; }

    .lang-menu{
      position:absolute; right:0; top:calc(100% + 8px); z-index:var(--z-lang);
      background:#fff; border:1px solid #e5e7eb; border-radius:10px; box-shadow:var(--shadow-md);
      padding:.35rem; min-width:120px; display:none;
    }
    .lang-menu.open{ display:block; }
    .lang-menu a{
      display:block; padding:.5rem .65rem; text-decoration:none; color:#111827; border-radius:8px; font-weight:600;
    }
    .lang-menu a:hover{ background:#f3f4f6; }
    .lang-menu a[aria-current="true"]{ color:#1a73e8; }

    .mobile-panel{
      display:block;
      position:fixed; inset:64px 0 0 0; background:var(--whiteglass);
      backdrop-filter: blur(6px); padding:1rem;
    }
    [hidden]{ display:none !important; }
    .mobile-links{ display:flex; flex-direction:column; gap:.8rem; }
    .mobile-links a{ text-decoration:none; color:var(--text); font-weight:600; padding:.7rem 0; border-bottom:1px solid #ddd; }
    .mobile-links a:last-child{ border-bottom:none; }

    .container{ flex:1; max-width:var(--container); margin:2rem auto; padding:0 1rem; }

    .hero{ background:var(--panel); padding:2.4rem 1.4rem; border-radius:var(--radius); text-align:center; box-shadow:var(--shadow-md); }
    .hero h2{ font-size:2.1rem; margin:.2rem 0 .7rem; }
    .subtitle{ font-size:1.08rem; color:var(--muted); margin:0 auto; max-width:800px; }

    .glance{ margin-top:1rem; display:grid; grid-template-columns:repeat(12,1fr); gap:.8rem; }
    .glance .item{
      grid-column:span 12; background:#fff; border-radius:10px; box-shadow:var(--shadow-sm);
      padding:.9rem 1rem; text-align:left;
    }
    .glance .item strong{ display:block; margin-bottom:.25rem; }

    .quick{ margin-top:1rem; display:flex; gap:.6rem; justify-content:center; flex-wrap:wrap; }
    .btn{
      display:inline-block; background:var(--brand); color:#fff; text-decoration:none;
      padding:.6rem 1rem; border-radius:10px; font-weight:700; transition:transform .06s ease;
    }
    .btn:hover{ background:var(--brand-hover); transform:translateY(-1px); }
    .btn:active{ transform:translateY(0); }
    .btn.outline{ background:transparent; color:var(--brand); border:2px solid var(--brand); }
    .btn.outline:hover{ background:#e8f0fe; }

    .content{ margin-top:2rem; background:var(--whiteglass); padding:2rem; border-radius:var(--radius); box-shadow:var(--shadow-sm); }
    .content h3{ font-size:1.55rem; margin:.2rem 0 .6rem; }

    /* Teaser (wird für News wiederverwendet) */
    .teaser{ margin-top:2rem; background:var(--whiteglass); padding:1.2rem; border-radius:var(--radius); box-shadow:var(--shadow-sm); }
    .teaser h3{ margin:.1rem 0 .6rem; font-size:1.3rem; text-align:center; }
    .posts{ display:grid; grid-template-columns:repeat(12,1fr); gap:.8rem; }
    .post{ grid-column:span 12; background:#fff; border-radius:10px; padding:.9rem 1rem; box-shadow:var(--shadow-sm); }
    .post h4{ margin:.2rem 0 .25rem; font-size:1.05rem; }
    .post .meta{ font-size:.9rem; color:#6b7280; margin:.1rem 0 .2rem; }
    .post a.cta{ font-weight:600; color:#fff; background:var(--brand); padding:.4rem .7rem; border-radius:8px; text-decoration:none; display:inline-block; }
    .post a.cta:hover{ background:var(--brand-hover); }

    .cta{ margin-top:2rem; background:#f7fafc; padding:2rem; text-align:center; border-radius:var(--radius); box-shadow:var(--shadow-sm); }
    .cta a{ display:inline-block; margin-top:1rem; background:var(--brand); color:#fff; text-decoration:none; padding:.7rem 1.4rem; border-radius:10px; font-weight:700; }
    .cta a:hover{ background:var(--brand-hover); }

    footer{ text-align:center; padding:1rem; margin-top:3rem; font-size:.95rem; color:#4a4a4a; background:var(--whiteglass); border-top-left-radius:var(--radius); border-top-right-radius:var(--radius); }

    .chat-fab{
      position:fixed; right:18px; bottom:18px; z-index:30;
      display:inline-flex; align-items:center; gap:.5rem;
      padding:.8rem 1rem; border-radius:999px; background:var(--brand); color:#fff; text-decoration:none;
      box-shadow:var(--shadow-md);
    }
    .chat-fab:hover{ background:var(--brand-hover); }

    .cookie-banner{
      position:fixed; z-index:var(--z-cookie); inset:auto 12px 12px 12px;
      background:#ffffff; border:1px solid #e5e7eb; border-radius:12px; box-shadow:var(--shadow-md);
      padding:1rem; display:none; max-width:800px; margin:0 auto;
    }
    .cookie-actions{ display:flex; gap:.6rem; flex-wrap:wrap; margin-top:.6rem; }
    .cookie-banner .btn{ padding:.55rem 1rem; }
    .cookie-banner .btn.minor{ background:#eef2ff; color:#1f2a66; border:1px solid #c7d2fe; }

    @media (min-width: 680px){
      .glance .item{ grid-column:span 4; }
      .post{ grid-column:span 4; }
    }
    @media (max-width: 980px){
      nav.primary{ display:none; }
      .burger{ display:inline-flex; }
    }
    @media (prefers-reduced-motion: reduce){
      *{ scroll-behavior:auto; transition:none !important; }
    }
  </style>
</head>
<body>
  <!-- Skip-Link -->
  <a class="skip-link" href="#main">Zum Hauptinhalt springen</a>

  <div class="overlay">
    <!-- NAVIGATION -->
    <header class="navbar" role="navigation" aria-label="Hauptnavigation">
      <a class="brand" href="index-de.html">
        <img src="Logo_sophira.png" alt="Logo Sophira" loading="eager" fetchpriority="high" />
        <h1>Sophira</h1>
      </a>

      <nav class="primary" aria-label="Hauptlinks">
        <a href="index-de.html" aria-current="page">Startseite</a>
        <a href="team-de.html">Team</a>
        <a href="project-de.html">Soziales Projekt</a>
        <a href="dashboard-de.html">Dashboard</a>
        <a href="jobs/index-de.html">Job-Portal</a>
        <a href="blog.html">Blog</a>
        <a href="contact-de.html">Kontakt</a>
        <a href="https://chatgpt.com/g/g-68d273dcee0081918dc19a72db072503-sophira-ai-assistant" target="_blank" rel="noopener" aria-label="Sophira Assistent in neuem Tab öffnen">Sophira Assistent</a>
        <span class="lang desktop" aria-label="Sprache wechseln">
          <a href="index.html" lang="fr">FR</a> |
          <a href="index-de.html" lang="de" aria-current="true">DE</a>
        </span>
      </nav>

      <!-- Rechte Steuerleiste (Mobile) -->
      <div class="controls">
        <!-- Sprachen-Button -->
        <button class="lang-btn" id="lang-btn" aria-haspopup="true" aria-expanded="false" aria-controls="lang-menu" aria-label="Sprache wechseln">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke-width="2"/><path d="M2 12h20M12 2a15.3 15.3 0 010 20M12 2a15.3 15.3 0 000 20" stroke-width="2" stroke-linecap="round"/></svg>
          DE
        </button>
        <div id="lang-menu" class="lang-menu" role="menu" aria-label="Sprachauswahl" aria-hidden="true">
          <a href="index.html" lang="fr" role="menuitem">Français</a>
          <a href="index-de.html" lang="de" aria-current="true" role="menuitem">Deutsch</a>
        </div>

        <!-- Burger -->
        <button class="burger" id="burger" aria-label="Menü öffnen" aria-controls="menu-mobile" aria-expanded="false">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <path d="M3 6h18M3 12h18M3 18h18" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- MOBILES MENÜ -->
    <div id="menu-mobile" class="mobile-panel" role="dialog" aria-modal="true" aria-label="Mobiles Menü" aria-hidden="true" hidden>
      <div class="mobile-links">
        <a href="index-de.html" aria-current="page">Startseite</a>
        <a href="team-de.html">Team</a>
        <a href="project-de.html">Soziales Projekt</a>
        <a href="dashboard-de.html">Dashboard</a>
        <a href="jobs/index-de.html">Job-Portal</a>
        <a href="blog.html">Blog</a>
        <a href="contact-de.html">Kontakt</a>
        <a href="https://chatgpt.com/g/g-68d273dcee0081918dc19a72db072503-sophira-ai-assistant" target="_blank" rel="noopener">Sophira Assistent</a>
      </div>
    </div>

    <!-- INHALT -->
    <main id="main" class="container">
      <!-- HERO -->
      <section class="hero">
        <h2>Talente von morgen fördern</h2>
        <p class="subtitle">
          Sophira ist ein gemeinnütziger Schweizer Verein, der Erwachsene unterstützt,
          die bei ihrer beruflichen Neuorientierung in Zukunftsberufe – von Daten bis zu grünen Technologien – auf Hindernisse stossen.
        </p>

        <!-- Auf einen Blick -->
        <div class="glance" aria-label="Auf einen Blick">
          <div class="item">
            <strong>Zielgerichtetes Stipendium</strong>
            Deckt einen Teil der Ausbildungs- und der wichtigsten Ausrüstungskosten ab.
          </div>
          <div class="item">
            <strong>Mentoring & Netzwerk</strong>
            Vermittlung, Coaching und konkretes Feedback von Fachleuten.
          </div>
          <div class="item">
            <strong>Reale Projekte</strong>
            Sozial wirksame Fälle, um schnell ein glaubwürdiges Portfolio aufzubauen.
          </div>
        </div>

        <!-- Schnelle Links -->
        <div class="quick" role="group" aria-label="Schnelle Links">
          <a class="btn" href="project-de.html">Projekt verstehen</a>
          <a class="btn outline" href="contact-de.html">Kontaktiert werden</a>
          <a class="btn" href="donate-de.html">Projekt unterstützen</a>
        </div>
      </section>

      <!-- INFO -->
      <section class="content">
        <h3>Warum Sophira?</h3>
        <p>Sophira entstand aus der Überzeugung, dass die digitalen und ökologischen Transformationen den Arbeitsmarkt verändern
          und dabei oft Erwachsene in prekären Situationen ausschliessen. Gleichzeitig steigt in der Schweiz der Bedarf
          an qualifizierten Fachkräften in diesen Bereichen.</p>
        <p>Wir setzen uns dafür ein, Barrieren abzubauen und konkrete Chancen zu schaffen. Sophira begleitet Erwachsene bei der Neuorientierung
          in sinnstiftende Berufe, vermittelt die nötigen digitalen und analytischen Kompetenzen und bietet finanzielle sowie menschliche Unterstützung.</p>
      </section>

      <!-- *** NEWS-TEASER: ersetzt "Lesenswert im Blog" *** -->
      <section class="teaser" aria-label="Aktuelle Nachrichten aus dem Blog">
        <h3>Aktuelle Nachrichten (aus dem Blog)</h3>
        <div id="news-list" class="posts" role="list">
          <!-- Wird per JS aus /news-feed.json oder /news-config.json befüllt -->
        </div>
        <p style="text-align:center; margin-top:.8rem;">
          <a class="btn outline" href="blog.html#news">Mehr Nachrichten im Blog</a>
        </p>
        <noscript>
          <p style="text-align:center">Bitte JavaScript aktivieren. Besuchen Sie unsere <a href="blog.html#news">News-Sektion</a>.</p>
        </noscript>
      </section>

      <!-- CTA FINAL -->
      <section class="cta" aria-label="Unterstützen">
        <h3>Unterstützen Sie unsere Vision</h3>
        <p>Gestalten wir gemeinsam eine gerechtere Zukunft, indem wir neue Talente durch Solidarität und lebenslanges Lernen fördern.</p>
        <a href="donate-de.html">Projekt unterstützen</a>
      </section>
    </main>

    <footer>
      <p>&copy; 2025 Sophira Verein | Basel, Schweiz</p>
    </footer>
  </div>

  <!-- GPT-FAB -->
  <a class="chat-fab" href="https://chatgpt.com/g/g-68d273dcee0081918dc19a72db072503-sophira-ai-assistant" target="_blank" rel="noopener" aria-label="Mit dem Sophira Assistenten sprechen (öffnet in neuem Tab)">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><path d="M21 15a4 4 0 0 1-4 4H8l-5 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4v8z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
    <span>Sophira Assistent</span>
  </a>

  <!-- Cookie-Banner (Consent) -->
  <div id="cookie-banner" class="cookie-banner" role="dialog" aria-live="polite" aria-label="Datenschutzeinstellungen" aria-modal="true">
    <p><strong>Cookies & Datenschutz.</strong> Wir verwenden funktionale Cookies für den Betrieb der Website und – mit Ihrer Einwilligung – Reichweitenmessung (Google Analytics). Sie können die Analyse jederzeit annehmen oder ablehnen.</p>
    <div class="cookie-actions">
      <button class="btn minor" id="cookie-refuse">Analyse ablehnen</button>
      <button class="btn" id="cookie-accept">Analyse akzeptieren</button>
      <button class="btn outline" id="cookie-later" aria-label="Später entscheiden">Später</button>
    </div>
  </div>

  <!-- JS: Menüs + Consent + NEWS FEED -->
  <script>
    // ===== Consent (localStorage) =====
    const CONSENT_KEY = 'sophira_consent_v1';
    function readConsent(){
      try { return JSON.parse(localStorage.getItem(CONSENT_KEY)) || null; } catch(e){ return null; }
    }
    function applyConsentToGtag(prefs){
      const analyticsGranted = !!(prefs && prefs.analytics);
      gtag('consent','update',{
        analytics_storage: analyticsGranted ? 'granted' : 'denied',
        ad_storage:'denied', ad_user_data:'denied', ad_personalization:'denied'
      });
    }
    function acceptAnalytics(){
      const prefs = { necessary:true, analytics:true, marketing:false, date:new Date().toISOString() };
      localStorage.setItem(CONSENT_KEY, JSON.stringify(prefs));
      applyConsentToGtag(prefs);
      hideCookieBanner();
    }
    function refuseAnalytics(){
      const prefs = { necessary:true, analytics:false, marketing:false, date:new Date().toISOString() };
      localStorage.setItem(CONSENT_KEY, JSON.stringify(prefs));
      applyConsentToGtag(prefs);
      hideCookieBanner();
    }
    function showCookieBanner(){
      const b = document.getElementById('cookie-banner');
      if(b) b.style.display = 'block';
    }
    function hideCookieBanner(){
      const b = document.getElementById('cookie-banner');
      if(b) b.style.display = 'none';
    }

    (function initConsent(){
      const prefs = readConsent();
      if (prefs) {
        applyConsentToGtag(prefs);
        hideCookieBanner();
      } else {
        showCookieBanner();
      }
      const btnA = document.getElementById('cookie-accept');
      const btnR = document.getElementById('cookie-refuse');
      const btnL = document.getElementById('cookie-later');
      if(btnA) btnA.addEventListener('click', acceptAnalytics);
      if(btnR) btnR.addEventListener('click', refuseAnalytics);
      if(btnL) btnL.addEventListener('click', hideCookieBanner);
    })();

    // ===== Navigation: Burger & Sprachmenü =====
    (function(){
      const burger = document.getElementById('burger');
      const panel  = document.getElementById('menu-mobile');
      const langBtn = document.getElementById('lang-btn');
      const langMenu = document.getElementById('lang-menu');

      function openMobile(){
        panel.removeAttribute('hidden');
        panel.setAttribute('aria-hidden','false');
        burger.setAttribute('aria-expanded','true');
        document.body.classList.add('no-scroll');
      }
      function closeMobile(){
        panel.setAttribute('hidden','');
        panel.setAttribute('aria-hidden','true');
        burger.setAttribute('aria-expanded','false');
        document.body.classList.remove('no-scroll');
      }
      function toggleMobile(){
        if(panel.hasAttribute('hidden')){ closeLang(); openMobile(); } else { closeMobile(); }
      }

      function openLang(){
        langMenu.classList.add('open');
        langMenu.setAttribute('aria-hidden','false');
        langBtn.setAttribute('aria-expanded','true');
      }
      function closeLang(){
        langMenu.classList.remove('open');
        langMenu.setAttribute('aria-hidden','true');
        langBtn.setAttribute('aria-expanded','false');
      }
      function toggleLang(e){
        e.stopPropagation();
        if(langMenu.classList.contains('open')){ closeLang(); }
        else { closeMobile(); openLang(); }
      }

      if(burger && panel){ burger.addEventListener('click', toggleMobile); }
      if(langBtn && langMenu){ langBtn.addEventListener('click', toggleLang); }

      document.addEventListener('click', (e)=>{
        if(langMenu && langMenu.classList.contains('open')){
          const insideLang = langMenu.contains(e.target) || langBtn.contains(e.target);
          if(!insideLang) closeLang();
        }
        if(panel && !panel.hasAttribute('hidden')){
          const insideMob = panel.contains(e.target) || (burger && burger.contains(e.target));
          if(!insideMob) closeMobile();
        }
      });
      document.addEventListener('keydown', (e)=>{
        if(e.key==='Escape'){ closeLang(); closeMobile(); }
      });
    })();

    /* ===== NEWS TEASER: try /news-feed.json, fallback to /news-config.json seed_urls ===== */
    (function(){
      const target = document.getElementById('news-list');
      if(!target) return;

      const MAX = 3;

      function fmt(d){
        try{
          const dt = new Date(d);
          if(!isNaN(dt)) return dt.toLocaleDateString('de-CH',{year:'numeric',month:'short',day:'2-digit'});
        }catch(e){}
        return '';
      }
      function domain(u){
        try{ return new URL(u).hostname.replace(/^www\./,''); }catch(e){ return ''; }
      }

      function normalizeFeed(json){
        const raw = Array.isArray(json) ? json
                   : Array.isArray(json?.items) ? json.items
                   : Array.isArray(json?.news) ? json.news
                   : [];
        return raw.map(x=>({
          title:  x.title || x.headline || '',
          url:    x.url || x.link || '#',
          lang:  (x.lang || x.language || '').toLowerCase(),
          date:   x.published_at || x.date || x.published || x.pubDate || '',
          source: x.source || x.site || domain(x.url || x.link || ''),
          pinned: !!x.pinned,
          shown:  x.shown !== false && x.published !== false
        }));
      }

      function fromConfigSeeds(cfg){
        const deSeeds = (cfg?.languages?.de?.seed_urls || []).map(u=>({
          title:'', url:u, lang:'de', date:'', source:domain(u), pinned:false, shown:true
        }));
        const frSeeds = (cfg?.languages?.fr?.seed_urls || []).map(u=>({
          title:'', url:u, lang:'fr', date:'', source:domain(u), pinned:false, shown:true
        }));
        return [...deSeeds, ...frSeeds];
      }

      function pickTop3(items){
        const vis = items.filter(i=>i.shown);
        const byDate = (a,b)=> (b.pinned - a.pinned) || (new Date(b.date) - new Date(a.date));
        const de = vis.filter(i=>i.lang==='de').sort(byDate);
        const others = vis.filter(i=>i.lang!=='de').sort(byDate);
        const out = [...de.slice(0,MAX)];
        if(out.length<MAX) out.push(...others.slice(0, MAX - out.length));
        return out.slice(0,MAX);
      }

      function render(items){
        target.innerHTML = '';
        if(!items.length){
          target.innerHTML = `
            <article class="post">
              <h4>News-Feed derzeit nicht verfügbar</h4>
              <p class="meta">Bitte besuchen Sie unsere News-Sektion im Blog.</p>
              <a class="cta" href="blog.html#news">Zum Blog</a>
            </article>`;
          return;
        }
        items.forEach(i=>{
          const card = document.createElement('article');
          card.className = 'post';
          card.setAttribute('role','listitem');
          card.innerHTML = `
            <h4>${i.title || i.url}</h4>
            <p class="meta">${i.source || ''}${i.date ? ' · ' + fmt(i.date) : ''}</p>
            <a class="cta" href="${i.url}" target="_blank" rel="noopener">Zur Meldung</a>
          `;
          target.appendChild(card);
        });
      }

      fetch('/news-feed.json', {cache:'no-store'})
        .then(r => r.ok ? r.json() : Promise.reject(r.status))
        .then(json => render(pickTop3(normalizeFeed(json))))
        .catch(() => {
          fetch('/news-config.json', {cache:'no-store'})
            .then(r => r.ok ? r.json() : Promise.reject(r.status))
            .then(cfg => render(pickTop3(fromConfigSeeds(cfg))))
            .catch(() => render([]));
        });
    })();
  </script>
</body>
</html>
